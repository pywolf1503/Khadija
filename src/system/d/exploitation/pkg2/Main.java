package system.d.exploitation.pkg2;
import java.util.ArrayList;
import java.util.List;

/**
 * La classe {@code Main} est la classe principale du programme qui simule un système de production
 * avec une usine et des clients.
 */
public class Main {

    /**
     * La méthode principale {@code main} est le point d'entrée du programme.
     *
     * @param args Les arguments de la ligne de commande (non utilisés dans cet exemple).
     */
    public static void main(String[] args) {
        // Nombre de clients à simuler
        int nClients = 1;

        // Liste des clients et des threads associés
        List<client> clients = new ArrayList<>();
        List<Thread> clientThreads = new ArrayList<>();

        // Initialisation de l'entrepôt
        entrepot ent = new entrepot();
        ent.init();
        Thread entThread = new Thread(ent);

        // Création de l'usine et association de l'entrepôt
        usine us = new usine();
        us.setEntrepot(ent);

        // Démarrage du thread de l'usine
        Thread usinethread = new Thread(us);
        usinethread.start();
        // Création des clients et de leurs threads associés
        for (int i = 0; i < nClients; i++) {
            clients.add(new client());
            client client = clients.get(i);
            client.setEnt(ent);
            clientThreads.add(new Thread(client));
        }

        // Démarrage des threads des clients
        for (Thread clientThread : clientThreads) {
            clientThread.start();
        }
        ent.setUsineThread(usinethread);
        ent.setUsine(us);
        entThread.start();


        // Attente de la fin du thread de l'usine et des threads des clients
        try {
            entThread.join();
            usinethread.join();
            for (Thread thread : clientThreads) {
                thread.join();
            }
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
